<div class="container-fluid">
    <div class="row d-print-none bg-light shadow-sm">
        <div class="col-auto">
            <div class="form-group">
                <label for="fiscalYear">‡¶Ö‡¶∞‡ßç‡¶•‡¶¨‡¶õ‡¶∞</label>
                <select class="form-control" id="fiscalYear" (change)="onSelectFiscalYear($event.target.value)">
                    <option value=""> ‡¶Ö‡¶∞‡ßç‡¶•‡¶¨‡¶õ‡¶∞ ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶® </option>
                    <option *ngFor="let fy of fiscalYearList" [value]="fy.id" [selected]="fy.active">
                        {{ fy.name }}
                    </option>
                </select>
            </div>
        </div>
        <div class="col-md-4">
            <label for="typeahead-prevent-manual-entry">‡¶ï‡¶∞‡ßç‡¶Æ‡¶ï‡¶∞‡ßç‡¶§‡¶æ‡¶∞ ‡¶Ü‡¶á‡¶°‡¶ø ‡¶ü‡¶æ‡¶á‡¶™ ‡¶ï‡¶∞‡ßÅ‡¶®</label>
            <input id="typeahead-prevent-manual-entry" type="text" class="form-control" (selectItem)="searchEmployee($event)" [(ngModel)]="employee"
                [ngbTypeahead]="search" [inputFormatter]="formatter" [resultFormatter]="formatter" [editable]='false' />
        </div>
    </div>
    <div class="row">
        <div class="col-md-12" *ngIf="employee && fiscalYear">
            <h5 class="h3 text-center pt-2">
                <strong> ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶∏‡¶Ç‡¶Ø‡ßã‡¶ú‡¶® </strong>
            </h5>

            <div class="form-group row mb-1">
                <label for="fiscalYear" class="col-sm-2 col-form-label text-right">‡¶Ö‡¶∞‡ßç‡¶• ‡¶¨‡¶õ‡¶∞</label>
                <div class="col-sm-2">
                    <label id="fiscalYear" class="form-control">{{fiscalYear.name}}</label>
                </div>
                <label for="fiscalYear" class="col-sm-2 col-form-label text-right">‡¶Ö‡¶û‡ßç‡¶ö‡¶≤/‡¶¨‡¶ø‡¶≠‡¶æ‡¶ó</label>
                <div class="col-sm-2">
                    <label id="fiscalYear" class="form-control">{{employee.zone}}</label>
                </div>
                <label for="fiscalYear" class="col-sm-2 col-form-label text-right">‡¶∏‡¶Æ‡¶æ‡¶™‡¶®‡ßÄ ‡¶∏‡ßç‡¶•‡¶ø‡¶§‡¶ø </label>
                <div class="col-sm-2">
                    <label id="fiscalYear" class="form-control">0</label>
                </div>
            </div>
            <div class="form-group row mb-1">
                <label for="fiscalYear" class="col-sm-2 col-form-label text-right">‡¶π‡¶ø‡¶∏‡¶æ‡¶¨ ‡¶®‡¶Ç / ‡¶Ü‡¶á‡¶°‡¶ø ‡¶®‡¶Ç </label>
                <div class="col-sm-2">
                    <label id="fiscalYear" class="form-control">{{employee.empId}}</label>
                </div>
                <label for="fiscalYear" class="col-sm-2 col-form-label text-right">‡¶ú‡¶®‡ßç‡¶Æ ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ</label>
                <div class="col-sm-3">
                    <label id="fiscalYear" class="form-control">{{employee.dateOfBirth.day}}/{{employee.dateOfBirth.month}}/{{employee.dateOfBirth.year}}</label>
                </div>
                <label for="fiscalYear" class="col-sm-1 col-form-label text-right">‡¶™‡¶¶‡¶¨‡ßÄ</label>
                <div class="col-sm-2">
                    <label id="fiscalYear" class="form-control">{{employee.designation}}</label>
                </div>
            </div>
            <div class="form-group row mb-1">
                <label for="fiscalYear" class="col-sm-2 col-form-label text-right">‡¶®‡¶æ‡¶Æ</label>
                <div class="col-sm-4">
                    <label class="form-control">{{employee.name}}</label>
                </div>
                <label for="fiscalYear" class="col-sm-2 col-form-label text-right">‡¶™‡¶ø‡¶§‡¶æ‡¶∞ ‡¶®‡¶æ‡¶Æ</label>
                <div class="col-sm-4">
                    <label class="form-control">{{employee.fatehrName}}</label>
                </div>
            </div>
            <div class="form-group row mb-1">
                <label for="fiscalYear" class="col-sm-2 col-form-label text-right">‡¶ö‡¶≤‡¶§‡¶ø ‡¶¨‡¶õ‡¶∞‡ßá‡¶∞ ‡¶∏‡ßÅ‡¶¶‡ßá‡¶∞ ‡¶π‡¶æ‡¶∞</label>
                <div class="col-sm-1">
                    <label *ngIf="!edit" class="form-control">{{currentYearInterestRate}}</label>
                    <input *ngIf="edit" class="form-control" type="number" [(ngModel)]="currentYearInterestRate" (keyup)="updateTotal()">
                </div>
                <label for="fiscalYear" class="col-sm-2 col-form-label text-right">‡¶∏‡ßç‡¶•‡¶ø‡¶§‡¶ø‡¶∞ ‡¶â‡¶™‡¶∞ ‡¶∏‡ßÅ‡¶¶‡ßá‡¶∞ ‡¶π‡¶æ‡¶∞</label>
                <div class="col-sm-1">
                    <label *ngIf="!edit" class="form-control">{{previousYearInterestRate}}</label>
                    <input *ngIf="edit" class="form-control" type="number" [(ngModel)]="previousYearInterestRate" (keyup)="updateTotal()">
                </div>
                <label for="fiscalYear" class="col-sm-2 col-form-label text-right">‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡¶¨‡¶∞‡ßç‡¶§‡ßÄ ‡¶≤‡ßã‡¶®</label>
                <div class="col-sm-1">
                    <span *ngIf="!edit" class="form-control">{{account?.previousYearLoan}}</span>
                    <input *ngIf="edit" type="number" class="form-control" [(ngModel)]="account.previousYearLoan" (keyup)="updateTotal()">
                </div>
                <label for="fiscalYear" class="col-sm-2 col-form-label text-right">‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶® ‡¶≤‡ßã‡¶®</label>
                <div class="col-sm-1">
                    <label class="form-control">{{account?.currentLoanStatus}}</label>
                </div>
            </div>

            <div class="table-responsive">
                <table class="table table-bordered">
                    <thead>
                        <tr>
                            <td *ngFor="let n of serialNumber">{{n}}</td>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>‡¶Æ‡¶æ‡¶∏‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ</td>
                            <td *ngFor="let m of monthName">{{m}}</td>
                            <td>‡¶â‡¶™‡¶Æ‡ßã‡¶ü</td>
                            <td>‡¶Æ‡ßã‡¶ü</td>
                            <td>‡¶ö‡¶≤‡¶§‡¶ø ‡¶∏‡¶æ‡¶≤‡ßá‡¶∞ ‡¶∏‡ßÅ‡¶¶</td>
                            <td>‡¶ó‡¶§ ‡¶¨‡¶õ‡¶∞‡ßá‡¶∞ ‡¶∏‡ßç‡¶•‡¶ø‡¶§‡¶ø</td>
                            <td>‡¶è‡¶á ‡¶¨‡¶õ‡¶∞‡ßá‡¶∞ ‡¶™‡ßç‡¶∞‡¶æ‡¶∞‡¶Æ‡ßç‡¶≠‡¶ø‡¶ï ‡¶∏‡ßç‡¶•‡¶ø‡¶§‡¶ø</td>
                            <td>‡¶è‡¶á ‡¶¨‡¶õ‡¶∞‡ßá‡¶∞ ‡¶∏‡ßÅ‡¶¶</td>
                            <td>‡¶∏‡¶Æ‡¶æ‡¶™‡¶®‡ßÄ</td>
                        </tr>
                        <tr>
                            <td>‡¶®‡¶ø‡¶ú ‡¶ï‡¶∞‡ßç‡¶§‡¶®</td>
                            <td *ngFor="let sbl of account?.subAccountList; let i = index">
                                <span *ngIf="!edit">{{sbl.selfDeduction}}</span>
                                <input *ngIf="edit" type="number" class="form-control" [(ngModel)]="sbl.selfDeduction" (keyup)="updateTotal()">
                            </td>
                            <td>{{account?.subTotal[0]}}</td>
                            <td>{{account?.total}}</td>
                            <td>{{account?.currentYearInterest}}</td>
                            <td>
                                <span *ngIf="!edit">{{account?.lastYearBalance}}</span>
                                <input *ngIf="edit" type="number" class="form-control" [(ngModel)]="account.lastYearBalance" (keyup)="updateTotal()">
                            </td>
                            <td>{{account?.currentYearBalance}}</td>
                            <td>{{account?.lastYearInterest}}</td>
                            <td>{{account?.grandTotal}}</td>
                        </tr>
                        <tr>
                            <td>‡¶ï‡¶®‡ßç‡¶ü‡ßç‡¶∞‡¶ø‡¶¨‡¶ø‡¶â‡¶∂‡¶®</td>
                            <td *ngFor="let sbl of account?.subAccountList; let i = index">
                                <span *ngIf="!edit">{{sbl.organizationalContribution}}</span>
                                <input *ngIf="edit" type="number" class="form-control" [(ngModel)]="sbl.organizationalContribution" (keyup)="updateTotal()">
                            </td>
                            <td>{{account?.subTotal[1]}}</td>
                            <td rowspan="4" colspan="6" *ngIf="account?.advances?.length" class="p-2">
                                <h5 class="text-center">‡¶Ö‡¶ó‡ßç‡¶∞‡¶ø‡¶Æ ‡¶™‡ßç‡¶∞‡¶¶‡¶æ‡¶®‡ßá‡¶∞ ‡¶¨‡¶ø‡¶¨‡¶∞‡¶£</h5>
                                <table class="table table-bordered ">
                                    <thead>
                                        <tr>
                                            <th>‡¶™‡ßç‡¶∞‡¶¶‡¶æ‡¶®‡ßá‡¶∞ ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ</th>
                                            <th>‡¶ö‡ßá‡¶ï ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞</th>
                                            <th>‡¶Ö‡¶∞‡ßç‡¶•‡ßá‡¶∞ ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr *ngFor="let adv of account.advances">
                                            <td>{{adv.issueDate.day}}/{{adv.issueDate.month}}/{{adv.issueDate.year}}/</td>
                                            <td>{{adv.checkNumber}}</td>
                                            <td>{{adv.amount}}</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </td>
                        </tr>
                        <tr>
                            <td>‡¶Ö‡¶ó‡ßç‡¶∞‡¶ø‡¶Æ ‡¶ï‡¶∞‡ßç‡¶§‡¶®</td>
                            <td *ngFor="let sbl of account?.subAccountList; let i = index">
                                <span *ngIf="!edit">{{sbl.advanceDeduction}}</span>
                                <input *ngIf="edit" type="number" class="form-control" [(ngModel)]="sbl.advanceDeduction" (keyup)="updateTotal()">
                            </td>
                            <td>{{account?.subTotal[2]}}</td>
                            <!-- <td></td>
                            <td>‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡¶¨‡¶∞‡ßç‡¶§‡ßÄ ‡¶≤‡ßã‡¶®</td>
                            <td>‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶® ‡¶≤‡ßã‡¶®</td> -->

                        </tr>
                        <tr>
                            <td>‡¶Ö‡¶ó‡ßç‡¶∞‡¶ø‡¶Æ ‡¶™‡ßç‡¶∞‡¶¶‡¶æ‡¶®</td>
                            <td *ngFor="let sbl of account?.subAccountList; let i = index">
                                <span>{{sbl.advanceReturn}}</span>
                            </td>
                            <td>{{account?.subTotal[3]}}</td>
                        </tr>
                        <tr>
                            <td>‡¶Ö‡¶§‡¶ø‡¶∞‡¶ø‡¶ï‡ßç‡¶§ ‡¶ï‡¶∞‡ßç‡¶§‡¶®</td>
                            <td *ngFor="let sbl of account?.subAccountList; let i = index">
                                <span *ngIf="!edit">{{sbl.extraDeduction}}</span>
                                <input *ngIf="edit" type="number" class="form-control" [(ngModel)]="sbl.extraDeduction" (keyup)="updateTotal()">
                            </td>
                            <td>{{account?.subTotal[4]}}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="col-md-12" *ngIf="showAdvanceForm">
            <advance-form (create)="onCreateAdvance($event)"></advance-form>
        </div>
        <div class="col-md-12" *ngIf="account">
            <div class="d-flex flex-row-reverse bd-highlight">
                <!-- <button class="btn btn-sm btn-primary mx-1">Print</button> -->
                <button class="btn btn-sm btn-warning mx-1" *ngIf="!edit" (click)="edit=true">‡¶è‡¶°‡¶ø‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®</button>
                <button class="btn btn-sm btn-success mx-1" *ngIf="edit && !exists" (click)="save()">‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
                <button class="btn btn-sm btn-warning mx-1" *ngIf="edit && exists" (click)="update()">‡¶π‡¶æ‡¶≤‡¶®‡¶æ‡¶ó‡¶æ‡¶¶ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
                <button class="btn btn-sm btn-success mx-1" (click)="onShowAdvanceForm()">‡¶Ö‡¶ó‡ßç‡¶∞‡¶ø‡¶Æ ‡¶™‡ßç‡¶∞‡¶¶‡¶æ‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</button>
            </div>
        </div>
    </div>
</div>